import{i as A,j as e,k as R,a as b,d as T,r as w,J as k,B as x,T as v}from"./index-C_g83nc7.js";import{T as L}from"./ToolContent-CPG3NUPt.js";import{I as M}from"./ContentPaste-CjGTXkhv.js";import{I as S}from"./InputFooter-BEiN93nS.js";import{T as y}from"./ToolFileResult-UmzxLoM8.js";import{F as _,f as N}from"./index-on_GoYzL.js";import{R as W}from"./RadioGroup-vFhw0Wb0.js";import{F as $}from"./FormControlLabel-BYSc6Di4.js";import{R as B}from"./Radio-UAGSoQ3a.js";import"./TextField-BB1W8KIt.js";import"./grey-pattern-DMflWW5d.js";import"./ResultFooter-BsMB-Y2y.js";import"./FormGroup-Dk72eAmu.js";import"./SwitchBase-BBer0tk-.js";var j={},E=R;Object.defineProperty(j,"__esModule",{value:!0});var C=j.default=void 0,V=E(A()),q=e;C=j.default=(0,V.default)((0,q.jsx)("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3z"}),"MusicNote");function O({value:i,onChange:p,accept:r,title:l,type:u}){const{t:s}=b();T();const m=w.useRef(null),{showSnackBar:d}=w.useContext(k),f=o=>{const a=o.target.files;a&&p([...i,...Array.from(a).map(h=>({file:h,order:i.length}))])},g=()=>{var o;(o=m.current)==null||o.click()};function c(){p([])}function t(o){return o.length>15?o.slice(0,15)+"...":o}return e.jsxs(x,{children:[e.jsx(M,{title:l||s("toolMultipleAudioInput.inputTitle",{type:u.charAt(0).toUpperCase()+u.slice(1)})}),e.jsx(x,{sx:{width:"100%",height:"300px",border:i!=null&&i.length?0:1,borderRadius:2,boxShadow:"5",bgcolor:"background.paper",position:"relative"},children:e.jsx(x,{width:"100%",height:"100%",sx:{overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",position:"relative"},children:i!=null&&i.length?i.map((o,a)=>e.jsxs(x,{sx:{margin:1,display:"flex",alignItems:"center",justifyContent:"space-between",width:"200px",border:1,borderRadius:1,padding:1},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{}),e.jsx(v,{sx:{marginLeft:1},children:t(o.file.name)})]}),e.jsx(x,{sx:{cursor:"pointer"},onClick:()=>{const h=i.filter((F,I)=>I!==a);p(h)},children:"âœ–"})]},a)):e.jsx(v,{variant:"body2",color:"text.secondary",children:s("toolMultipleAudioInput.noFilesSelected")})})}),e.jsx(S,{handleImport:g,handleClear:c}),e.jsx("input",{ref:m,style:{display:"none"},type:"file",accept:r.join(","),onChange:f,multiple:!0})]})}const n=new _;async function D(i,p){if(n.loaded||await n.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"}),i.length===0)throw new Error("No input files provided");const{outputFormat:r}=p,l=`output.${r}`,u=[];for(let t=0;t<i.length;t++){const o=`input${t}`,a=`temp${t}.wav`;await n.writeFile(o,await N(i[t])),await n.exec(["-i",o,"-acodec","pcm_s16le","-ar","44100","-ac","2",a]),u.push(a),await n.deleteFile(o)}const s="filelist.txt",m=u.map(t=>`file '${t}'`).join(`
`);await n.writeFile(s,m);const d="concat.wav";await n.exec(["-f","concat","-safe","0","-i",s,"-c","copy",d]);let f=d;if(r!=="wav"){const t=["-i",d];r==="mp3"?t.push("-ar","44100","-ac","2","-b:a","192k","-f","mp3",l):r==="aac"&&t.push("-c:a","aac","-b:a","192k","-f","adts",l),await n.exec(t),f=l}const g=await n.readFile(f);let c="audio/wav";r==="mp3"&&(c="audio/mp3"),r==="aac"&&(c="audio/aac");for(const t of u)await n.deleteFile(t);return await n.deleteFile(s),await n.deleteFile(d),r!=="wav"&&await n.deleteFile(l),new File([new Blob([g],{type:c})],`merged_audio.${r}`,{type:c})}const G={outputFormat:"mp3"},P=[{label:"MP3",value:"mp3"},{label:"AAC",value:"aac"},{label:"WAV",value:"wav"}];function re({title:i,longDescription:p}){const{t:r}=b("audio"),[l,u]=w.useState([]),[s,m]=w.useState(null),[d,f]=w.useState(!1),g=async(t,o)=>{if(o.length!==0){f(!0);try{const a=o.map(F=>F.file),h=await D(a,t);m(h)}catch(a){console.error(`Failed to merge audio: ${a}`),m(null)}finally{f(!1)}}},c=({values:t,updateField:o})=>[{title:r("mergeAudio.outputFormat"),component:e.jsx(x,{mt:2,children:e.jsx(W,{row:!0,value:t.outputFormat,onChange:a=>o("outputFormat",a.target.value),children:P.map(a=>e.jsx($,{value:a.value,control:e.jsx(B,{}),label:a.label},a.value))})})}];return e.jsx(L,{title:i,input:l,inputComponent:e.jsx(O,{value:l,onChange:u,accept:["audio/*",".mp3",".wav",".aac"],title:r("mergeAudio.inputTitle"),type:"audio"}),resultComponent:d?e.jsx(y,{title:r("mergeAudio.mergingAudio"),value:null,loading:!0}):e.jsx(y,{title:r("mergeAudio.resultTitle"),value:s,extension:s?s.name.split(".").pop():void 0}),initialValues:G,getGroups:c,setInput:u,compute:g,toolInfo:{title:r("mergeAudio.toolInfo.title",{title:i}),description:p}})}export{re as default};
