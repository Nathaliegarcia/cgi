import{r as C,j as r,B as b}from"./index-C_g83nc7.js";import{T as j}from"./ToolImageInput-CFNY9OjJ.js";import{C as I}from"./CheckboxWithDesc-wy5nrFmd.js";import{C as P}from"./ColorSelector-Burpi3L5.js";import{T as v}from"./TextFieldWithDesc-PPwE1_13.js";import{T as D}from"./ToolFileResult-UmzxLoM8.js";import{C as G}from"./index-D0yirmFn.js";import{c as R}from"./index.esm-BXeXpCuG.js";import{a as E}from"./color-zwma1Zlz.js";import{T as N}from"./ToolContent-CPG3NUPt.js";import"./BaseFileInput-c8nMlesD.js";import"./ContentPaste-CjGTXkhv.js";import"./InputFooter-BEiN93nS.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-Ccv-xqw_.js";import"./FormControlLabel-BYSc6Di4.js";import"./Checkbox-eIAKSjSC.js";import"./SwitchBase-BBer0tk-.js";import"./TextField-BB1W8KIt.js";import"./ResultFooter-BsMB-Y2y.js";const S={enableTransparency:!1,color:"white",similarity:"10"};R({});function V({title:x}){const[h,u]=C.useState(null),[y,d]=C.useState(null),T=async(e,o)=>{if(!o)return;const t=async(n,p)=>{const a=document.createElement("canvas"),c=a.getContext("2d");if(c==null)return;const s=new Image;if(s.src=URL.createObjectURL(n),await s.decode(),a.width=s.width,a.height=s.height,c.drawImage(s,0,0),p){const{color:m,similarity:g}=p,f=c.getImageData(0,0,a.width,a.height),l=f.data;for(let i=0;i<l.length;i+=4){const w=[l[i],l[i+1],l[i+2]];E(w,m,g)&&(l[i+3]=0)}c.putImageData(f,0,0)}a.toBlob(m=>{if(m){const g=new File([m],n.name,{type:"image/png"});d(g)}},"image/png")};if(e.enableTransparency){let n;try{n=G(e.color).rgb().array()}catch{return}t(o,{color:n,similarity:Number(e.similarity)})}else t(o)};return r.jsx(N,{title:x,input:h,inputComponent:r.jsx(j,{value:h,onChange:u,accept:["image/jpeg"],title:"Input JPG"}),resultComponent:r.jsx(D,{title:"Output PNG",value:y,extension:"png"}),initialValues:S,getGroups:({values:e,updateField:o})=>[{title:"PNG Transparency Color",component:r.jsxs(b,{children:[r.jsx(I,{title:"Enable PNG Transparency",checked:!!e.enableTransparency,onChange:t=>o("enableTransparency",t),description:"Make the color below transparent."},"enableTransparency"),r.jsx(P,{value:e.color,onColorChange:t=>o("color",t),description:"With this color (to color)",inputProps:{"data-testid":"color-input"}}),r.jsx(v,{value:e.similarity,onOwnChange:t=>o("similarity",t),description:"Match this % of similar. For example, 10% white will match white and a little bit of gray."})]})}],compute:T,setInput:u})}export{V as default};
