import{a as h,r as c,j as s,B as F,az as v}from"./index-C_g83nc7.js";import{T}from"./ToolContent-CPG3NUPt.js";import{F as j,f as b}from"./index-on_GoYzL.js";import{T as y}from"./ToolVideoInput-BOFRr1sH.js";import{T as d}from"./ToolFileResult-UmzxLoM8.js";import{T as C}from"./TextFieldWithDesc-PPwE1_13.js";import{c as S,d as I}from"./index.esm-BXeXpCuG.js";import"./TextField-BB1W8KIt.js";import"./objectWithoutProperties-CAq07jI_.js";import"./BaseFileInput-c8nMlesD.js";import"./ContentPaste-CjGTXkhv.js";import"./InputFooter-BEiN93nS.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-Ccv-xqw_.js";import"./ResultFooter-BsMB-Y2y.js";const l=new j;async function L(e,p){l.loaded||await l.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"});const o="input.mp4",a="output.mp4";await l.writeFile(o,await b(e));const t=[],i=p.loops-1;if(i<=0)return e;t.push("-stream_loop",i.toString()),t.push("-i",o),t.push("-c:v","libx264","-preset","ultrafast",a),await l.exec(t);const m=await l.readFile(a);return await new File([new Blob([m],{type:"video/mp4"})],`${e.name.replace(/\.[^/.]+$/,"")}_looped.mp4`,{type:"video/mp4"})}const N={loops:2},R=S({loops:I().min(1,"Number of loops must be greater than 1")});function J({title:e,longDescription:p}){const{t:o}=h("video"),[a,t]=c.useState(null),[i,m]=c.useState(null),[x,f]=c.useState(!1),w=async(u,r)=>{if(r)try{f(!0);const n=await L(r,u);await m(n)}catch(n){console.error(n)}finally{f(!1)}},g=({values:u,updateField:r})=>[{title:o("loop.loops"),component:s.jsx(F,{children:s.jsx(C,{onOwnChange:n=>v(n,"loops",r),value:u.loops,label:o("loop.numberOfLoops")})})}];return s.jsx(T,{title:e,input:a,inputComponent:s.jsx(y,{value:a,onChange:t}),resultComponent:x?s.jsx(d,{value:null,title:o("loop.loopingVideo"),loading:!0,extension:""}):s.jsx(d,{value:i,title:o("loop.resultTitle"),extension:"mp4"}),initialValues:N,validationSchema:R,getGroups:g,setInput:t,compute:w,toolInfo:{title:o("loop.toolInfo.title",{title:e}),description:p}})}export{J as default};
