import{r as f,j as e,B as y,az as C}from"./index-C_g83nc7.js";import{c as B,d as S,e as N}from"./index.esm-BXeXpCuG.js";import{T as O}from"./ToolContent-CPG3NUPt.js";import{T as v}from"./TextFieldWithDesc-PPwE1_13.js";import{T as U}from"./ToolVideoInput-BOFRr1sH.js";import{T as k}from"./ToolFileResult-UmzxLoM8.js";import{S as l}from"./SimpleRadio-kuqVngOy.js";import{f as W,F as D}from"./index-on_GoYzL.js";import"./TextField-BB1W8KIt.js";import"./objectWithoutProperties-CAq07jI_.js";import"./BaseFileInput-c8nMlesD.js";import"./ContentPaste-CjGTXkhv.js";import"./InputFooter-BEiN93nS.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-Ccv-xqw_.js";import"./ResultFooter-BsMB-Y2y.js";import"./Radio-UAGSoQ3a.js";import"./SwitchBase-BBer0tk-.js";const H={quality:"mid",fps:"10",scale:"320:-1:flags=bicubic",start:0,end:100};B({start:S().min(0,"Start time must be positive"),end:S().min(N("start"),"End time must be greater than start time")});function lt({title:p,longDescription:q}){const[u,g]=f.useState(null),[$,G]=f.useState(null),[E,x]=f.useState(!1),I=(o,t)=>{if(!t)return;const{fps:s,scale:c,start:m,end:V}=o;let i=null,d=!1;(async(h,w,b,T,j)=>{x(!0),i||(i=new D),d||(await i.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"}),d=!0);const a=h.name,n="output.gif";try{i.writeFile(a,await W(h)),await i.exec(["-i",a,"-ss",T.toString(),"-to",j.toString(),"-vf",`fps=${w},scale=${b},palettegen`,"palette.png"]),await i.exec(["-i",a,"-i","palette.png","-ss",T.toString(),"-to",j.toString(),"-filter_complex",`fps=${w},scale=${b}[x];[x][1:v]paletteuse`,n]);const r=await i.readFile(n),L=new Blob([r],{type:"image/gif"}),z=new File([L],n,{type:"image/gif"});await i.deleteFile(a),await i.deleteFile(n),G(z)}catch(r){throw console.error(`Failed to convert video: ${r}`),r}finally{x(!1)}})(t,s,c,m,V)},R=({values:o,updateField:t})=>[{title:"Set Quality",component:e.jsxs(y,{children:[e.jsx(l,{title:"Low",onClick:()=>{t("quality","low"),t("fps","5"),t("scale","240:-1:flags=bilinear")},checked:o.quality==="low"}),e.jsx(l,{title:"Mid",onClick:()=>{t("quality","mid"),t("fps","10"),t("scale","320:-1:flags=bicubic")},checked:o.quality==="mid"}),e.jsx(l,{title:"High",onClick:()=>{t("quality","high"),t("fps","15"),t("scale","480:-1:flags=lanczos")},checked:o.quality==="high"}),e.jsx(l,{title:"Ultra",onClick:()=>{t("quality","ultra"),t("fps","15"),t("scale","640:-1:flags=lanczos")},checked:o.quality==="ultra"})]})},{title:"Timestamps",component:e.jsxs(y,{children:[e.jsx(v,{onOwnChange:s=>C(s,"start",t),value:o.start,label:"Start Time",sx:{mb:2,backgroundColor:"background.paper"}}),e.jsx(v,{onOwnChange:s=>C(s,"end",t),value:o.end,label:"End Time"})]})}];return e.jsx(O,{title:p,input:u,renderCustomInput:({start:o,end:t},s)=>e.jsx(U,{value:u,onChange:g,title:"Input Video",showTrimControls:!0,onTrimChange:(c,m)=>{s("start",c),s("end",m)},trimStart:o,trimEnd:t}),resultComponent:E?e.jsx(k,{title:"Converting to Gif",value:null,loading:!0}):e.jsx(k,{title:"Converted to Gif",value:$,extension:"gif"}),initialValues:H,getGroups:R,setInput:g,compute:I,toolInfo:{title:`What is a ${p}?`,description:q}})}export{lt as default};
