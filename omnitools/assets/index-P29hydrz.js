import{a as v,r as s,j as i,B as j,az as u}from"./index-C_g83nc7.js";import{c as F,d,e as y}from"./index.esm-BXeXpCuG.js";import{T as $}from"./ToolFileResult-UmzxLoM8.js";import{T as B}from"./ToolContent-CPG3NUPt.js";import{T as f}from"./TextFieldWithDesc-PPwE1_13.js";import{F as R,f as k}from"./index-on_GoYzL.js";import{l as I}from"./lodash-Ccv-xqw_.js";import{T as N}from"./ToolVideoInput-BOFRr1sH.js";import"./ContentPaste-CjGTXkhv.js";import"./grey-pattern-DMflWW5d.js";import"./ResultFooter-BsMB-Y2y.js";import"./TextField-BB1W8KIt.js";import"./objectWithoutProperties-CAq07jI_.js";import"./BaseFileInput-c8nMlesD.js";import"./InputFooter-BEiN93nS.js";const a=new R,D={trimStart:0,trimEnd:100},O=F({trimStart:d().min(0,"Start time must be positive"),trimEnd:d().min(y("trimStart"),"End time must be greater than start time")});function X({title:x}){const{t:m}=v("video"),[p,l]=s.useState(null),[T,g]=s.useState(null),w=async(r,t)=>{if(!t)return;const{trimStart:e,trimEnd:n}=r;try{a.loaded||await a.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"});const o="input.mp4",c="output.mp4";await a.writeFile(o,await k(t)),await a.exec(["-i",o,"-ss",e.toString(),"-to",n.toString(),"-c","copy",c]);const S=await a.readFile(c),C=new Blob([S],{type:"video/mp4"}),E=new File([C],`${t.name.replace(/\.[^/.]+$/,"")}_trimmed.mp4`,{type:"video/mp4"});g(E)}catch(o){console.error("Error trimming video:",o)}},b=s.useCallback(I.debounce(w,1e3),[]),h=({values:r,updateField:t})=>[{title:m("trim.timestamps"),component:i.jsxs(j,{children:[i.jsx(f,{onOwnChange:e=>u(e,"trimStart",t),value:r.trimStart,label:m("trim.startTime"),sx:{mb:2,backgroundColor:"background.paper"}}),i.jsx(f,{onOwnChange:e=>u(e,"trimEnd",t),value:r.trimEnd,label:m("trim.endTime")})]})}];return i.jsx(B,{title:x,input:p,renderCustomInput:({trimStart:r,trimEnd:t},e)=>i.jsx(N,{value:p,onChange:l,title:m("trim.inputTitle"),showTrimControls:!0,onTrimChange:(n,o)=>{e("trimStart",n),e("trimEnd",o)},trimStart:r,trimEnd:t}),resultComponent:i.jsx($,{title:m("trim.resultTitle"),value:T,extension:"mp4"}),initialValues:D,getGroups:h,compute:b,setInput:l,validationSchema:O})}export{X as default};
