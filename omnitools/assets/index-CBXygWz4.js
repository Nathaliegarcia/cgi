import{a as g,r as m,j as o,B as h}from"./index-C_g83nc7.js";import{c as F,d as b}from"./index.esm-BXeXpCuG.js";import{T as f}from"./ToolFileResult-UmzxLoM8.js";import{T as j}from"./ToolContent-CPG3NUPt.js";import{l as C}from"./lodash-Ccv-xqw_.js";import{T}from"./ToolVideoInput-BOFRr1sH.js";import{F as R,f as y}from"./index-on_GoYzL.js";import{S}from"./SimpleRadio-kuqVngOy.js";import"./ContentPaste-CjGTXkhv.js";import"./grey-pattern-DMflWW5d.js";import"./ResultFooter-BsMB-Y2y.js";import"./TextField-BB1W8KIt.js";import"./objectWithoutProperties-CAq07jI_.js";import"./BaseFileInput-c8nMlesD.js";import"./InputFooter-BEiN93nS.js";import"./Radio-UAGSoQ3a.js";import"./SwitchBase-BBer0tk-.js";const i=new R;async function k(n,e){i.loaded||await i.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"});const a="input.mp4",r="output.mp4";await i.writeFile(a,await y(n));const l={90:"transpose=1",180:"transpose=2,transpose=2",270:"transpose=2",0:""}[e],s=["-i",a];l&&s.push("-vf",l),s.push("-c:v","libx264","-preset","ultrafast",r),await i.exec(s);const p=await i.readFile(r);return new File([new Blob([p],{type:"video/mp4"})],`${n.name.replace(/\.[^/.]+$/,"")}_rotated.mp4`,{type:"video/mp4"})}const V={rotation:90},$=F({rotation:b().oneOf([0,90,180,270],"Rotation must be 0, 90, 180, or 270 degrees").required("Rotation is required")}),E=[{value:90,label:"90째 Clockwise"},{value:180,label:"180째 (Upside down)"},{value:270,label:"270째 (90째 Counter-clockwise)"}];function W({title:n}){const{t:e}=g("video"),[a,r]=m.useState(null),[d,l]=m.useState(null),[s,p]=m.useState(!1),v=async(c,u)=>{if(u){p(!0);try{const t=await k(u,c.rotation);l(t)}catch(t){console.error("Error rotating video:",t)}finally{p(!1)}}},x=m.useCallback(C.debounce(v,1e3),[]),w=({values:c,updateField:u})=>[{title:e("rotate.rotation"),component:o.jsx(h,{children:E.map(t=>o.jsx(S,{title:e(`rotate.${t.value}Degrees`),checked:c.rotation===t.value,onClick:()=>{u("rotation",t.value)}},t.value))})}];return o.jsx(j,{title:n,input:a,inputComponent:o.jsx(T,{value:a,onChange:r,title:e("rotate.inputTitle")}),resultComponent:s?o.jsx(f,{title:e("rotate.rotatingVideo"),value:null,loading:!0,extension:""}):o.jsx(f,{title:e("rotate.resultTitle"),value:d,extension:"mp4"}),initialValues:V,getGroups:w,compute:x,setInput:r,validationSchema:$})}export{W as default,V as initialValues,$ as validationSchema};
